# Chess Challenge

> Level -  :green_circle: :green_circle: :green_circle: :green_circle: :green_circle:

Если вы, посмотрев сериал "The Queen's Gambit", купили себе шахматный набор, то наш новый челлендж именно для вас. 

**Компьютерные шахматы** — популярный термин из области исследования искусственного интеллекта, означающий создание программного обеспечения и специальных компьютеров для игры в шахматы. 
**Цель** данного челленджа - написать свою шахматную программу.

Разработчики [шахматных программ](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D0%B5_%D1%88%D0%B0%D1%85%D0%BC%D0%B0%D1%82%D1%8B) должны сделать ряд решений при их написании. Они включают:

- Способ изображения шахматной доски — представление цельной позиции как структуры данных.
- Методы поиска — поиск возможных лучших ходов.
- Листовая оценка — оценка позиции без учёта дальнейших ходов.

## Визуализация шахматной доски с генерацией ходов

На шахматной доске 8 горизонталей, которые обозначены латинскими буквами a, b, c, d, e, f, g, h, и 8 вертикалей,которые обозначаются арабскими цифрами 1, 2, 3, 4, 5, 6, 7, 8, всего 64 клетки, из них 32 белые и 32 черные. Каждый игрок перед началом игры имеет 16 фигур: 8 пешек, 2 ладьи, 2 коня, 2 слона, короля и ферзя. 

На этом этапе можно использовать библиотеки [chess.js](https://github.com/jhlywa/chess.js) для генерации ходов и [chessboard.js](https://github.com/jhlywa/chess.js) для визуализации доски. Библиотека, которая отвечает за генерацию ходов, позволяет применять все шахматные правила, так что есть возможность рассчитывать каждое действие для конкретного расположения фигур.

![illustration1](https://github.com/startupemulator/challenges/blob/c0d1cb6a0e942475169c2ccf8e37fd3f5802f637/Chess/1png)

## Правила игры

### **Ход в шахматах**

Кто играет белым цветом, тот первый и ходит. Ход – это передвижение своей фигуры на не занятое поле, если это не взятие. Взятие же – это передвижение своей фигуры на место фигуры соперника, при этом фигура соперника снимается с доски. 

### **Как ходят фигуры**

**Король** – самая главная фигура в шахматах, цель игры в шахматы - поставить мат королю, после этого игра прекращается. Кто поставит мат, тот и выигрывает партию. Король - единственная фигура, которая не может взять фигуру, если она защищена, он также не имеет право ходить под шах, к тому же не может приблизиться к вражескому ферзю и королю (ближе, чем на одну клетку). У короля может быть самое большее восемь клеток, на которые он мо­жет переместиться. Если король стоит на краю доски, у него остается только пять возможных ходов, а если в углу - только три.

![king](https://github.com/startupemulator/challenges/blob/main/Chess/1360443417_kak-hodit-korol.png)

**Ладья** - ходит и бьет фигуры противника на любое доступное поле по вертикалям или горизонталям, на которых находится. Вот пример на картинке. Ладья не может пойти на крайнее левое поле доски - там расположен ее король. А вот черную пешку она может забрать, то есть снять с доски, и стать на ее место. 

![ladia](https://github.com/startupemulator/challenges/blob/main/Chess/1360443422_kak-hodit-ladya.png)

**Слон** ходит на любое доступное поле по диагонали. Обратите внимание, что один из слонов у каждого из игроков ходит только по белым полям (поэтому и называется - белопольным), а другой - только по черным полям (этот слон - чернопольный).

![slon](https://github.com/startupemulator/challenges/blob/main/Chess/1360443357_kak-hodit-slon.png)

**Конь** ходит буквой «Г». Он прыгает по горизонтали или вертикали через клетку и тут же переходит на соседнее боковое поле другого цвета. Конь - единственная шахматная фигура, способная перепрыгивать через другие фигуры. Вот как это может происходить.

![horse](https://github.com/startupemulator/challenges/blob/main/Chess/1360443383_kak-hodit-kon.png)

**Ферзь** - самая сильная фигура. Он совмещает ходы ладьи и слона и может с места, на котором находится, пойти на любое доступное поле по вертикали, по горизонтали или по диагоналям. Ферзь может пойти на любое поле, показанное стрелками, но может также взять ладью или слона черных. Для этого та или другая фигура снимается с доски, а ферзь ставится на ее место.

![fers](https://github.com/startupemulator/challenges/blob/main/Chess/1360443384_kak-hodit-ferz.png)

**Пешка** - их у каждого из соперников по 8. Пешки ходят только вперед по вертикали на одну клетку (если она не занята своей или чужой фигурой). Но из первоначального положения каждая пешка может один раз за всю игру пойти сразу на два поля. Среди других фигур только пешка бьет чужие фигуры не так, как ходит, а наискосок - на одну клетку вперед по диагонали.

![peshka](https://github.com/startupemulator/challenges/blob/main/Chess/1360443401_kak-bet-peshka.png)

### **Что такое рокировка**

Один раз во время игры каждый из королей (белый или черный) может сделать рокировку. Делается она так. Король перемещается по направлению к одной из ладей через одну клетку, а ладья переносится через него и становится рядом. Вот пример рокировки белого короля.

![rokirovka](https://github.com/startupemulator/challenges/blob/main/Chess/1360443408_rokirovka.png)

Рокировка на **королевском фланге** называется **короткой**, на **ферзевом - длинной**. Если король хоть однажды двигался, рокировка невозможна в обе стороны. Также нельзя рокироваться с ладьей, которая покидала свое место. Рокировка временно невозможна, если король в этот момент находится под нападением фигуры соперника, а также в том случае, если под ударом оказывается поле, которое король должен занять или пересечь. Нельзя также рокироваться, когда между королем и ладьей, с которой задумана рокировка, находится другая фигура.

![rokirovkinet](https://github.com/startupemulator/challenges/blob/main/Chess/1360443416_rokirovku-delat-nelzya.png)

**Взятие на проходе** - Если пешка делает из первоначального положения ход на два поля и переступает клетку, находящуюся под ударом неприятельской пешки, то последняя может побить двигавшуюся пешку. При этом двигавшаяся пешка снимается с доски, а бьющая становится не на ее место, как это происходит во всех других случаях, а на "битое" поле, которое та перепрыгнула.Подробности этого странного хода показаны на рисунке.

![vzatie](https://github.com/startupemulator/challenges/blob/main/Chess/1360443425_vzyatie-na-prohode.png)

### **Шах и мат**

Если любая фигура - ферзь, ладья, слон, конь или пешка - нападает на короля, то такое нападение называется **шахом**. От шаха нужно обязательно защититься следующим ходом. Есть три способа защиты. Можно отойти королем, уничтожить нападающую фигуру или же поставить между ней и королем свою фигуру. Возможны все три защиты от шаха черной ладьи. Белые могут увести короля, взять нападающую ладыо слоном или же заслонить короля ладьей.

![shah](https://github.com/startupemulator/challenges/blob/main/Chess/1360443433_shah.png)
 
**Мат**. Если ни один из способов защиты от шаха выполнить нельзя (нельзя увести короля, уничтожить нападающую фигуру или заслонить короля своей фигурой), то получается мат королю, партия прекращается. Партия считается выигранной, если удается объявить мат королю соперника, или в том случае, если противник сдается сам.

![mat](https://github.com/startupemulator/challenges/blob/main/Chess/1360443344_mat.png)

> Шахматные символы являются частью **Юникода**. Вместо использования изображений, можно представлять шахматные фигуры по символам, которые определены в наборе символов Юникода - [Chess symbols in Unicode](https://www.wikiwand.com/en/Chess_symbols_in_Unicode)

## Цифровая оценка шахматных позиций

Суть данного способа - дать цифровую оценку (цифровой вес) каждому отдельному позиционному фактору, влияющему на позицию, и создать алгоритм, который выбирает ход с максимальной оценкой. Такими [факторами](https://schoolchess.ru/uroki/dlya-1-razryada-i-kms/urok-35-ocenka-pozicii.html) являются: материальное преимущество, позиция короля, центр (владение центром), открытые линии, слабые и сильные поля, слабость в пешечной цепи, пешечное превосходство (количественное или качественное), пешечное напряжение, активность фигур. Для того чтобы определить точную оценку позиции,сравнивают все эти факторы и получают:

![posizia](https://github.com/startupemulator/challenges/blob/main/Chess/ozenkaposisii.png)

> Больше узнать про алгоритмы можно в статье ["Алгоритмы шахматных программ"](http://acm.mipt.ru/twiki/bin/view/Algorithms/ArlazarovChessAlgo)

## Полезные ссылки и ресурсы:

- [Garbochess-JS by Glinscott](https://github.com/glinscott/Garbochess-JS)
- [Coding Chess with TDD](https://dev.to/lukegarrigan/coding-chess-with-tdd-46j5)
- [Chess by lhartikk](https://jsfiddle.net/lhartikk/m14epfwb/4/)
- [«Победа сегфолтом» и другие эксплойты шахматных движков](https://m.habr.com/ru/post/532314/)
